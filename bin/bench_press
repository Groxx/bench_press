#!/usr/bin/env ruby
require 'optparse'
require 'bench_press'

options = {}

optparse = OptionParser.new do |opts|
  opts.banner = "Usage: bench_press [options] file_to_benchmark.rb"

  opts.on( '-p', '--publish', 'Publish the benchmark to http://rubybenchmark.com' ) do
    options[:publish] = true
  end

  opts.on( '-v', '--version', 'Show the version of bench_press' ) do
    options[:version] = true
  end
end

optparse.parse!

if options[:version]
  puts BenchPress::VERSION
  exit
end

filename = ARGV.first
abort "You must supply a filename that you want to benchmark." if filename.nil?

file = File.join(Dir.pwd, ARGV.first)
if File.exists?(file)
  $0 = file
  load file
else
  abort "The file #{file} does not exist."
end
